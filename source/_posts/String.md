---
title: 《C++编程思想》之字符串学习笔记   
date: 2016-12-08 21:10:07
tags: C++
---

字符串是C++标准库的一个重要组成部分，本文参照《C++编程思想》中字符串的相关内容，对该部分进行简单总结。
<!--more-->
### C字符型数组和C++字符串
在C语言中，字符串基本上就是字符串数组，并且总是以二进制零（空结束符）作为最末元素。C++ string与它们在C语言中的前身截然不同。首先，也是最重要的不同点，C++隐藏了它所包含的字符序列的物理表示。程序设计人员不必关心数组的维数或空结束符方面的问题。C++ string对象知道自己在内存中的开始位置、包含的内容、包含的字符长度以及在必需重新调整内部缓冲区的大小之前自己可以增长到的最大字符长度。C++字符串极大地减少了C语言编程中最常见且最具破坏性的错误：（1）超越数组边界；（2）通过未被初始化或被赋以错误值的指针来访问数组元素；（3）在释放了某一数组原先所分配的存储单元后仍保留了“悬挂”指针。      
C++标准没有定义字符串类内存布局的确切实现。采用这种体系结构是为了获得足够的灵活性，从而允许不同的编译器厂商能够提供不同的实现，并且向用户保证提供可预测的行为。

### 创建并初始化C++字符串
创建C++ string一般有以下几种方式：     
（1）`string temp;`  创建空string对象，且并不立即用字符数据对其初始化；     
（2）`string temp("hello world");`  将一个文字的引用数组作为参数传递给构造函数，以此来对一个string对象进行初始化；                
（3）`string temp = "hello world";`  用等号来初始化一个string对象;         
（4）`string temp(str);`		用一个string对象看来初始化另一个string对象。    
另外，还有一些相关的成员函数和特性：     
（1）用operator+来将不同的初始化数据源结合在一起；
	
		string s1("hello");
		std::cout << s1 + " world" << std::endl;		//hello world

（2）用string对象的成员函数substr()来创建一个子串。

		string s1("hello world, hello");
		std::cout << s1.substr(0, 11) << std::endl;		//hello world   \
string类对象的成员函数substr()将开始位置作为其第一个参数，而将待选字符的个数作为其第2个参数。     
（3）将string看做容器对象，利用string类的迭代器string::begin()和string::end()。

		string s1("hello world");
		string s2(s1.begin(), s2.end());
		std::cout << s2 << std::endl;		//hello world
不可以使用单个的字符、ASCII码或其他整数值来初始化C++字符串。

### 字符串的操作

标准C语言的char型数组工具中存在着其固有的误区，那就是它们都显示地依赖一种假设：字符数组包括一个空结束符。若由于疏忽或是其他差错，这个空结束符被忽略或重写，这个小小的差错就会使C语言的char数组处理函数几乎不可避免地操作其已分配空间之外的内存，有时会带来灾难性后果。  
C++提供的string类对象，在使用的便利性和安全性上都有很大的提高。     
#### 追加、插入和连接字符串
C++字符串一个便于使用的特色是：无需程序员干预，可根据需要自行扩充规模。这样程序员不再需要跟踪字符串的存储边界。此外，当字符串增长时，字符串成员函数append()--(追加)和insert()--(插入)很明显地重新分配了存储空间。     
此外，还有一些成员函数：capacity()返回当前分配的存储空间的规模；reserve(int size)提供一种优化机制，按照程序员的意图，预留一定数量的存储空间，以便将来使用。而如果要生成的新字符串的规模比当前的字符串大或者需要截断原字符串，resize()函数就会在字符串的末尾追加空格或是指定的字符。
#### 替换字符串的字符
insert()使程序员放心地向字符串中插入字符，而不必担心会使存储空间越界，或者会改写插入点之后紧跟的字符。存储空间增大了，原有的字符会该改变其存储位置，以便安置新元素。   
replace()用于替换（删除）字符串中的字符，如果对replace()的调用使“替换”超出了原有序列的边界，这与追加操作是等价的，这样replace()也会增加存储空间。       
此外，我们知道，STL中的算法功能很强大，由于string类几乎可以与STL容器等价，因此，string的很多解决方案可以由标准库的算法完成。比如，使用`std::replace(s.begin(), s.end(), 'X', 'Y')`将字符串中出现的某个字符（'X'）全部用另一个字符('Y')替换掉。这里的replace()是STL通用算法，不是string的成员函数。

#### 使用非成员重载运算符连接
C++ string类另一个令人欣喜的特性是可以借助operator+和operator+=来轻易地实现字符串的合并与追加操作。

	string str("hello");
	str += " world";
	cout << str << endl;		//hello world

### 字符串的查找

       
string成员函数中的find族是用来在给定字符串中定位某个或某组字符的。包括：   
（1）find()：在字符串中查找一个指定的单个字符或字符组；      
（2）find\_first\_of()：查找第一个与指定字符组任何字符匹配的字符位置；    
（3）find\_first\_not\_of()：查找第一个与指定字符组任何字符都不匹配的字符位置；    
（4）find\_last\_of();     
（5）find\_last\_not\_of();    
（6）rfind()：对一个字符串从尾到头查找指定的字符或字符组，返回首次匹配的开始位置。    
string类中没有改变字符串大小写的函数，可以借助于标准C语言的toupper()和tolower()实现，这两个函数以此只能改变一个字符的大小写。

### 字符串的删除
使用erase()成员函数删除字符串中的字符，该函数有两个参数：一个参数表示开始删除字符的位置（默认值是0）；另一个表示要删除多少个字符（默认值是string::npos）。如果指定删除的字符个数比字符串中剩余的字符还多，那么剩余的字符将全部删除，所以，调用不含参数的erase()函数将删除字符串中的所有字符。

### 字符串的比较

字符串的比较，简而言之就是：当两个字符串比较遇到第一对不同的字符时，字符串s1中第一个不同的字符比字符串s2中同样位置的字符在ASCII表中的位置更靠后，那么s1“大于”s2。      
C++提供了多种字符串比较方法，它们各具特色。其中最简单的就是使用非成员的重载运算符函数：operator==、operator!=、operator>、operator<、operator>=、operator<=。     
此外，string类还提供compare()成员函数，用以提供更复杂紧密的比较手段。用多种重载版本来对比较的字串做控制。     
C语言中获取字符串中的某个字符都是采用数组索引法（[]）,C++ string提供一种s[n]表示法的替代方法：at()成员函数。如果不出异常，这两种索引机制在C++中产生的结果是一样的。而有异常的情况时，比如程序员引用了一个超过边界的数组元素，at()将会友好地抛出一个异常，而普通的[]下标语法将让程序员自行决策。at()成员函数抛出的是一个out_of_range类对象，它(最终)派生于std::exception。程序可在一个异常处理器中捕获该对象，并采取适当的补救措施，比如重新计算越界下标或扩充数组。而string::operator[]()不会有那样的保护性，它的危险性等同于C语言中国对char型数组的处理。    

### C语言函数处理时的转换
C++ string提供了c\_str()函数返回一个const char\*，它指向一个C语言风格的具有“空结束符”的字符串，此字符串与string对象的内容等价。当想将一个字符串传送给一个标准C语言函数时，比如atoi()、printf()，const char\*可派上用场。不过，用c\_str()的返回值作为非const参数应用于任一函数都是错误的。    

